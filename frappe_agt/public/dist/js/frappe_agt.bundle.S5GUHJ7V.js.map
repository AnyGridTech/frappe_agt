{
  "version": 3,
  "sources": ["../../../../../apps/frappe_agt/frappe_agt/public/ts/utils/brazil/cnpj.ts", "../../../../../apps/frappe_agt/frappe_agt/public/ts/utils/brazil/cpf.ts", "../../../../../apps/frappe_agt/frappe_agt/public/ts/utils/brazil/cpf_cnpj.ts", "../../../../../apps/frappe_agt/frappe_agt/public/ts/utils/brazil/cep.ts", "../../../../../apps/frappe_agt/frappe_agt/public/ts/utils/brazil/phone.ts", "../../../../../apps/frappe_agt/frappe_agt/public/ts/utils/core.ts", "../../../../../apps/frappe_agt/frappe_agt/public/ts/utils/db/index.ts", "../../../../../apps/frappe_agt/frappe_agt/public/ts/utils/dialog.ts", "../../../../../apps/frappe_agt/frappe_agt/public/ts/utils/doc.ts", "../../../../../apps/frappe_agt/frappe_agt/public/ts/utils/form.ts", "../../../../../apps/frappe_agt/frappe_agt/public/ts/utils/table.ts", "../../../../../apps/frappe_agt/frappe_agt/public/ts/utils/text.ts"],
  "sourcesContent": ["import type { FrappeForm } from \"@anygridtech/frappe-types/client/frappe/core\";\n\nfrappe.provide('agt.utils.brazil.cnpj');\n\nagt.utils.brazil.cnpj.regex = /^(?!00\\.000\\.000\\/0000\\-00)(\\d{2}\\.\\d{3}\\.\\d{3}\\/\\d{4}\\-\\d{2})$/;\n\n/**\n * Validates a CNPJ number.\n * @param frm - The Frappe form instance\n * @param cnpj_field - The field containing the CNPJ number\n * @returns `true` if the CNPJ number is valid, otherwise `false`.\n */\nagt.utils.brazil.cnpj.validate = function (frm: FrappeForm, cnpj_field: string): void {\n  let cnpj = frm.doc[cnpj_field] || '';\n  cnpj = cnpj.replace(/\\D/g, '');\n\n  if (cnpj.length !== 14) {\n    frappe.msgprint(__('CNPJ must have 14 digits.'));\n    frm.set_value(cnpj_field, '');\n    return;\n  }\n\n  // Eliminate known invalid CNPJs\n  if (agt.utils.brazil.cnpj.regex.test(cnpj)) {\n    frappe.msgprint(__('Invalid CNPJ number.'));\n    frm.set_value(cnpj_field, '');\n    return;\n  }\n\n  // Validate verification digits\n  let length = cnpj.length - 2;\n  let numbers = cnpj.substring(0, length);\n  let digits = cnpj.substring(length);\n  let sum = 0;\n  let pos = length - 7;\n\n  for (let i = length; i >= 1; i--) {\n    sum += parseInt(numbers.charAt(length - i)) * pos--;\n    if (pos < 2) pos = 9;\n  }\n\n  let result = sum % 11 < 2 ? 0 : 11 - (sum % 11);\n  if (result !== parseInt(digits.charAt(0))) {\n    frappe.msgprint(__('Invalid CNPJ number.'));\n    frm.set_value(cnpj_field, '');\n    return;\n  }\n\n  length += 1;\n  numbers = cnpj.substring(0, length);\n  sum = 0;\n  pos = length - 7;\n\n  for (let i = length; i >= 1; i--) {\n    sum += parseInt(numbers.charAt(length - i)) * pos--;\n    if (pos < 2) pos = 9;\n  }\n\n  result = sum % 11 < 2 ? 0 : 11 - (sum % 11);\n  if (result !== parseInt(digits.charAt(1))) {\n    frappe.msgprint(__('Invalid CNPJ number.'));\n    frm.set_value(cnpj_field, '');\n    return;\n  }\n\n  // If valid, format the CNPJ\n  agt.utils.brazil.cnpj.format(frm, cnpj_field);\n}\n\n/**\n * Formats a CNPJ number field to the standard format (xx.xxx.xxx/xxxx-xx).\n * @param frm - The Frappe form instance\n * @param cnpj_field - The field containing the CNPJ number\n */\nagt.utils.brazil.cnpj.format = function (frm: FrappeForm, cnpj_field: string): void {\n  let cnpj = frm.doc[cnpj_field] || '';\n  cnpj = cnpj.replace(/\\D/g, '');\n\n  if (cnpj.length === 14) {\n    frm.set_value(cnpj_field, cnpj.replace(/(\\d{2})(\\d{3})(\\d{3})(\\d{4})(\\d{2})/, '$1.$2.$3/$4-$5'));\n  }\n}\n\n/**\n * Checks if a CNPJ exists by making an API call to validate it.\n * @param frm - The Frappe form instance\n * @param cnpj_field - The field containing the CNPJ number\n */\nagt.utils.brazil.cnpj.validate_existence = async function (frm: FrappeForm, cnpj_field: string): Promise<void> {\n  const cnpj = frm.doc[cnpj_field]?.replace(/\\D/g, '') || '';\n  \n  if (cnpj.length !== 14) {\n    frappe.msgprint(__('CNPJ must have 14 digits to check existence.'));\n    return;\n  }\n\n  try {\n    const response = await frappe.call({\n      method: 'check_cnpj_existence',\n      args: { cnpj }\n    });\n    \n    if (response.message && response.message.exists) {\n      frappe.msgprint(__('CNPJ exists and is valid.'));\n    } else {\n      frappe.msgprint(__('CNPJ not found in official records.'));\n    }\n  } catch (err) {\n    console.error('Error checking CNPJ existence:', err);\n    frappe.msgprint(__('Error checking CNPJ existence. Please try again.'));\n  }\n};", "import type { FrappeForm } from \"@anygridtech/frappe-types/client/frappe/core\";\n\nfrappe.provide('agt.utils.brazil.cpf');\n\nagt.utils.brazil.cpf.regex = /^(?!000\\.000\\.000\\-00)(\\d{3}\\.\\d{3}\\.\\d{3}\\-\\d{2})$/;\n\n/**\n * Validates a CPF number.\n * @param frm - The Frappe form instance\n * @param cpf_field - The field containing the CPF number\n */\nagt.utils.brazil.cpf.validate = function(frm: FrappeForm, cpf_field: string): void {\n  let cpf = frm.doc[cpf_field] || '';\n  cpf = cpf.replace(/\\D/g, '');\n\n  if (cpf.length !== 11) {\n    frappe.msgprint(__('CPF must have 11 digits.'));\n    frm.set_value(cpf_field, '');\n    return;\n  }\n  \n  // Eliminate known invalid CPFs\n  if (agt.utils.brazil.cpf.regex.test(cpf)) {\n    frappe.msgprint(__('Invalid CPF number.'));\n    frm.set_value(cpf_field, '');\n    return;\n  }\n\n  // Validate verification digits\n  let sum = 0;\n  let remainder;\n\n  for (let i = 1; i <= 9; i++) {\n    sum += parseInt(cpf.substring(i - 1, i)) * (11 - i);\n  }\n\n  remainder = (sum * 10) % 11;\n  if (remainder === 10 || remainder === 11) remainder = 0;\n  if (remainder !== parseInt(cpf.substring(9, 10))) {\n    frappe.msgprint(__('Invalid CPF number.'));\n    frm.set_value(cpf_field, '');\n    return;\n  }\n\n  sum = 0;\n  for (let i = 1; i <= 10; i++) {\n    sum += parseInt(cpf.substring(i - 1, i)) * (12 - i);\n  }\n\n  remainder = (sum * 10) % 11;\n  if (remainder === 10 || remainder === 11) remainder = 0;\n  if (remainder !== parseInt(cpf.substring(10, 11))) {\n    frappe.msgprint(__('Invalid CPF number.'));\n    frm.set_value(cpf_field, '');\n    return;\n  }\n\n  // If valid, format the CPF!\n  agt.utils.brazil.cpf.format(frm, cpf_field);\n}\n\n/**\n * Formats a CPF number field to the standard format (xxx.xxx.xxx-xx).\n * @param frm - The Frappe form instance\n * @param cpf_field - The field containing the CPF number\n */\nagt.utils.brazil.cpf.format = function(frm: FrappeForm, cpf_field: string): void {\n  let cpf = frm.doc[cpf_field] || '';\n  cpf = cpf.replace(/\\D/g, '');\n\n  if (cpf.length === 11) {\n    frm.set_value(cpf_field, cpf.replace(/(\\d{3})(\\d{3})(\\d{3})(\\d{2})/, '$1.$2.$3-$4'));\n  }\n}", "import type { FrappeForm } from \"@anygridtech/frappe-types/client/frappe/core\";\n\nfrappe.provide('agt.utils.brazil');\n\n/**\n * Sets up document ID validation and formatting on a form.\n * Handles both CPF and CNPJ validation depending on the type field.\n * @param frm - The Frappe form instance\n * @param field - The field name containing the document ID\n * @param documentType - The field name containing the document type (CPF/CNPJ)\n */\nagt.utils.brazil.validate_cnpj_or_cpf = function(frm: FrappeForm, field: string, documentType: 'cpf' | 'cnpj'): void {\n  if (documentType === 'cpf') {\n    agt.utils.brazil.cpf.validate(frm, field);\n  } else if (documentType === 'cnpj') {\n    agt.utils.brazil.cnpj.validate(frm, field);\n  } else {\n    // Auto-detect based on length\n    let value = frm.doc[field] || '';\n    value = value.replace(/\\D/g, '');\n\n    if (value.length === 11) {\n      agt.utils.brazil.cpf.validate(frm, field);\n    } else if (value.length === 14) {\n      agt.utils.brazil.cnpj.validate(frm, field);\n    }\n  }\n};\n\n/**\n * Formats a Brazilian document ID (CPF/CNPJ) on a form.\n * @param frm - The Frappe form instance\n * @param field - The field name containing the document ID\n * @param documentType - The type of document ('cpf' or 'cnpj')\n */\nagt.utils.brazil.format_cnpj_or_cpf = function(frm: FrappeForm, field: string, documentType: 'cpf' | 'cnpj'): void {\n  if (documentType === 'cpf') {\n    agt.utils.brazil.cpf.format(frm, field);\n  } else if (documentType === 'cnpj') {\n    agt.utils.brazil.cnpj.format(frm, field);\n  } else {\n    // Auto-detect based on length\n    let value = frm.doc[field] || '';\n    value = value.replace(/\\D/g, '');\n\n    if (value.length === 11) {\n      agt.utils.brazil.cpf.format(frm, field);\n    } else if (value.length === 14) {\n      agt.utils.brazil.cnpj.format(frm, field);\n    }\n  }\n};", "import type { FrappeForm } from \"@anygridtech/frappe-types/client/frappe/core\";\nimport type { CepApiResponse, ValidationStatus } from \"@anygridtech/frappe-agt-types/agt/client/utils/brazil\";\n\nfrappe.provide('agt.utils.brazil');\nfrappe.provide('agt.utils.brazil.cep');\n\n// CEP functions\nagt.utils.brazil.cep.regex = /^\\d{5}-?\\d{3}$/;\n\n/**\n * Formats a Brazilian ZIP code (CEP) to the standard format (xxxxx-xxx).\n * @param frm - The Frappe form instance\n * @param cep_field - The field containing the ZIP code\n * @returns The formatted ZIP code.\n */\nagt.utils.brazil.cep.format = function(frm: FrappeForm, cep_field: string): string {\n  let cep = frm.doc[cep_field] || '';\n  cep = cep.replace(/\\D/g, '');\n  \n  if (cep.length === 8) {\n    const formatted = `${cep.slice(0, 5)}-${cep.slice(5)}`;\n    frm.set_value(cep_field, formatted);\n    return formatted;\n  }\n  return cep;\n};\n\n/**\n * Validates a Brazilian ZIP code (CEP) and auto-fills address fields.\n * Makes an API call to check the ZIP code and update related fields.\n * @param frm - The Frappe form instance\n * @param field - The field containing the ZIP code\n * @param addr - The field to store the address\n * @param neigh - The field to store the neighborhood\n * @param town - The field to store the city\n * @param state - The field to store the state\n */\nagt.utils.brazil.cep.validate = async function (\n  frm: FrappeForm,\n  field: string,\n  addr: string,\n  neigh: string,\n  town: string,\n  state: string\n): Promise<void> {\n  const f = frm.fields_dict[field];\n  if (!f?.$input) return;\n  const $input = f.$input as JQuery<HTMLInputElement>;\n\n  /**\n   * Sets visual style icon based on validation status\n   */\n  const setVisualStyle = (status: ValidationStatus): string => {\n    switch (status) {\n      case 'warning':\n        return `<i class=\"fa fa-exclamation-circle\" style=\"color:#f1c40f\"></i> `;\n      case 'error':\n        return `<i class=\"fa fa-times-circle\" style=\"color:#e74c3c\"></i> `;\n      case 'success':\n        return `<i class=\"fa fa-check-circle\" style=\"color:#27ae60\"></i> `;\n      default:\n        return '';\n    }\n  };\n\n  /**\n   * Updates UI with validation feedback\n   */\n  const updateUI = (color: string, message: string): void => {\n    let status: ValidationStatus = 'default';\n    if (color === '#f1c40f') status = 'warning';\n    else if (color === 'red' || color === '#e74c3c') status = 'error';\n    else if (color === 'green' || color === '#27ae60') status = 'success';\n\n    const icon = setVisualStyle(status);\n    f['set_description'](\n      icon + (message ? `<b style=\"color:${color}\">${message}</b>` : '')\n    );\n  };\n\n  /**\n   * Fetches CEP data from server\n   */\n  const fetchCepData = async (cep: string): Promise<CepApiResponse | null> => {\n    try {\n      const response = await frappe.call({\n        method: 'check_cep',\n        args: { cep }\n      });\n      return response.message;\n    } catch (err) {\n      console.error('Erro ao consultar o CEP via server script:', err);\n      return null;\n    }\n  };\n\n  /**\n   * Validates CEP value and updates UI accordingly\n   */\n  const validateAndStyle = async (value: string): Promise<void> => {\n    const digits = value.replace(/\\D/g, '');\n\n    if (!digits) {\n      updateUI('', '');\n      return;\n    }\n\n    if (digits.length < 8) {\n      updateUI('#f1c40f', 'CEP incompleto');\n      return;\n    }\n\n    // Quando tiver 8 d\u00EDgitos -> consulta\n    const data = await fetchCepData(digits);\n    if (!data || data.message === 'CEP n\u00E3o encontrado') {\n      updateUI('red', 'CEP n\u00E3o encontrado');\n      return;\n    }\n\n    // CEP v\u00E1lido \u2192 preenche campos\n    frm.set_value(addr, data.street || '');\n    frm.set_value(neigh, data.neighborhood || '');\n    frm.set_value(town, data.city || '');\n    frm.set_value(state, data.state || '');\n\n    updateUI('green', 'CEP v\u00E1lido');\n  };\n\n  /**\n   * Formats CEP input and validates in real-time\n   */\n  const formatOnInput = async (e: Event): Promise<void> => {\n    const input = e.target as HTMLInputElement;\n    const originalValue = input.value;\n    const cursorBefore = input.selectionStart || 0;\n    const digitsBeforeCursor = originalValue.slice(0, cursorBefore).replace(/\\D/g, '').length;\n\n    // Apenas n\u00FAmeros\n    let digits = originalValue.replace(/\\D/g, '').slice(0, 8);\n\n    // Detecta se \u00E9 adi\u00E7\u00E3o (digitando) ou remo\u00E7\u00E3o\n    const currentFieldValue = frm.doc[field as keyof typeof frm.doc]?.toString() || '';\n    const isAdding = digits.length > currentFieldValue.replace(/\\D/g, '').length;\n\n    let formatted = digits;\n    if (isAdding && digits.length > 5) {\n      formatted = `${digits.slice(0, 5)}-${digits.slice(5)}`;\n    } else if (!isAdding) {\n      // Se est\u00E1 apagando, n\u00E3o for\u00E7ar tra\u00E7o\n      if (digits.length > 5 && originalValue.includes('-')) {\n        formatted = `${digits.slice(0, 5)}-${digits.slice(5)}`;\n      } else {\n        formatted = digits;\n      }\n    }\n\n    if (formatted !== originalValue) {\n      input.value = formatted;\n      frm.doc[field as keyof typeof frm.doc] = formatted;\n\n      // Ajusta cursor\n      let newCursor = 0;\n      let countDigits = 0;\n      for (const ch of formatted) {\n        newCursor++;\n        if (/\\d/.test(ch)) countDigits++;\n        if (countDigits >= digitsBeforeCursor) break;\n      }\n      while (newCursor < formatted.length && formatted[newCursor] && /\\D/.test(formatted[newCursor] || '')) {\n        newCursor++;\n      }\n      input.setSelectionRange(newCursor, newCursor);\n    }\n\n    // Valida\u00E7\u00E3o din\u00E2mica\n    await validateAndStyle(formatted);\n  };\n\n  // Remove eventos anteriores e adiciona novos\n  $input.off('.zipcode').on('input.zipcode', formatOnInput);\n\n  // Se j\u00E1 tiver valor ao carregar\n  const currentValue = frm.doc[field as keyof typeof frm.doc]?.toString();\n  if (currentValue) {\n    $input.trigger('input.zipcode');\n  }\n};\n\n\n\n", "import type { FrappeForm } from \"@anygridtech/frappe-types/client/frappe/core\";\nimport type { PhoneValidationResult, ValidationStatus } from \"@anygridtech/frappe-agt-types/agt/client/utils/brazil\";\n\nfrappe.provide('agt.utils.brazil');\nfrappe.provide('agt.utils.brazil.phone');\n\n// Phone functions\nagt.utils.brazil.phone.regex = /^\\(\\d{2}\\)\\s\\d{4,5}\\-\\d{4}$/;\n\n/**\n * Formats a phone number field to a standard format.\n * @param frm - The Frappe form instance.\n * @param phone_field - The field containing the phone number.\n */\nagt.utils.brazil.phone.format = function(frm: FrappeForm, phone_field: string): void {\n  let phone = frm.doc[phone_field] || '';\n  const digits = phone.replace(/\\D/g, '').slice(0, 11);\n  \n  if (digits.length <= 2) {\n    frm.set_value(phone_field, digits);\n    return;\n  }\n  if (digits.length <= 6) {\n    frm.set_value(phone_field, `(${digits.substring(0, 2)}) ${digits.substring(2)}`);\n    return;\n  }\n  if (digits.length <= 10) {\n    frm.set_value(phone_field, `(${digits.substring(0, 2)}) ${digits.substring(2, 6)}-${digits.substring(6)}`);\n    return;\n  }\n  frm.set_value(phone_field, `(${digits.substring(0, 2)}) ${digits.substring(2, 7)}-${digits.substring(7)}`);\n};\n\n/**\n * Validates and formats phone numbers with real-time masking.\n * Applies validation based on Brazilian phone number standards.\n * \n * @param frm - The Frappe form containing the phone field\n * @param phoneField - The name of the field containing the phone number\n * @returns Promise that resolves when validation setup is complete\n * \n * @example\n * // Basic usage with just the phone field\n * agt.utils.brazil.phone.validate(frm, 'phone_field');\n */\nagt.utils.brazil.phone.validate = function(frm: FrappeForm, phoneField: string): Promise<void> {\n  return new Promise<void>(resolve => {\n    const field = frm.fields_dict[phoneField];\n    if (!field?.$input) {\n      console.error(`validate_phone: O campo '${phoneField}' n\u00E3o foi encontrado ou n\u00E3o \u00E9 um campo de entrada v\u00E1lido.`);\n      return resolve();\n    }\n\n    const $input = field.$input as JQuery<HTMLInputElement>;\n\n    /**\n     * Sets visual style icon based on validation status\n     */\n    const setVisualStyle = (status: ValidationStatus): string => {\n      let icon = '';\n      switch (status) {\n        case 'warning':\n          icon = '<i class=\"fa fa-exclamation-circle\" style=\"color:#f1c40f\"></i> ';\n          break;\n        case 'error':\n          icon = '<i class=\"fa fa-times-circle\" style=\"color:#e74c3c\"></i> ';\n          break;\n        case 'success':\n          icon = '<i class=\"fa fa-check-circle\" style=\"color:#27ae60\"></i> ';\n          break;\n        default:\n          icon = '';\n      }\n      return icon;\n    };\n\n    /**\n     * Updates UI with validation feedback\n     */\n    const updateUI = (color: string, message: string): void => {\n      let status: ValidationStatus = 'default';\n      if (color === '#f1c40f') status = 'warning';\n      else if (color === 'red' || color === '#e74c3c') status = 'error';\n      else if (color === 'green' || color === '#27ae60') status = 'success';\n      const icon = setVisualStyle(status);\n      field['set_description'](icon + (message ? `<b style='color:${color}'>${message}</b>` : ''));\n    };\n\n    /**\n     * Validates Brazilian phone number format\n     */\n    const validatePhoneFormat = (phoneNumber: string): PhoneValidationResult => {\n      // Remover todos os caracteres n\u00E3o num\u00E9ricos\n      const digits = phoneNumber.replace(/\\D/g, '');\n\n      // Verificar se tem entre 10 ou 11 d\u00EDgitos (com DDD)\n      const hasValidLength = digits.length === 10 || digits.length === 11;\n      if (!hasValidLength) {\n        return { isValid: false, type: 'invalido' };\n      }\n\n      const invalidDDDs = [\n        0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,\n        20, 23, 25, 26, 29, 30,\n        36, 39, 40,\n        50, 52, 56, 57, 58, 59, 60,\n        70, 72, 76, 78, 80, 90\n      ];\n\n      // Extrair DDD\n      const ddd = parseInt(digits.substring(0, 2));\n\n      // Verificar se o DDD N\u00C3O est\u00E1 na lista de DDDs inv\u00E1lidos e est\u00E1 entre 11 e 99\n      const hasValidDDD = !invalidDDDs.includes(ddd) && ddd >= 11 && ddd <= 99;\n      if (!hasValidDDD) {\n        return { isValid: false, type: 'invalido' };\n      }\n\n      // Determinar se \u00E9 celular ou fixo\n      // Celular: 11 d\u00EDgitos e come\u00E7a com 9 ap\u00F3s o DDD\n      // Fixo: 10 d\u00EDgitos e o primeiro d\u00EDgito ap\u00F3s o DDD est\u00E1 entre 2-8\n      const firstDigitAfterDDD = parseInt(digits.substring(2, 3));\n\n      if (digits.length === 11 && firstDigitAfterDDD === 9) {\n        return { isValid: true, type: 'celular' };\n      } else if (digits.length === 10 && firstDigitAfterDDD >= 2 && firstDigitAfterDDD <= 8) {\n        return { isValid: true, type: 'fixo' };\n      } else {\n        return { isValid: false, type: 'invalido' };\n      }\n    };\n\n    /**\n     * Formats phone number to Brazilian standard\n     */\n    const formatPhoneNumber = (value: string): string => {\n      // Extrair apenas os d\u00EDgitos e limitar a 11 caracteres\n      const digits = value.replace(/\\D/g, '').slice(0, 11);\n\n      // Aplicar formata\u00E7\u00E3o no padr\u00E3o brasileiro\n      if (digits.length <= 2) return digits;\n      if (digits.length <= 6) return `(${digits.substring(0, 2)}) ${digits.substring(2)}`;\n      if (digits.length <= 10) return `(${digits.substring(0, 2)}) ${digits.substring(2, 6)}-${digits.substring(6)}`;\n      return `(${digits.substring(0, 2)}) ${digits.substring(2, 7)}-${digits.substring(7)}`;\n    };\n\n    /**\n     * Handles input formatting and validation in real-time\n     */\n    const formatOnInput = (e: Event): void => {\n      const input = e.target as HTMLInputElement;\n      const originalValue = input.value;\n\n      // Armazenar posi\u00E7\u00E3o do cursor antes da formata\u00E7\u00E3o\n      const originalPos = input.selectionStart || 0;\n      const digitsBeforeCursor = (originalValue.slice(0, originalPos).replace(/\\D/g, '')).length;\n\n      // Extrair apenas d\u00EDgitos do valor original\n      const digits = originalValue.replace(/\\D/g, '');\n\n      // Aplicar formata\u00E7\u00E3o\n      const formattedValue = formatPhoneNumber(digits);\n\n      // Atualizar o campo com o valor formatado\n      if (originalValue !== formattedValue) {\n        input.value = formattedValue;\n        frm.doc[phoneField] = formattedValue;\n\n        // Ajustar posi\u00E7\u00E3o do cursor\n        let newCursorPos = 0;\n        let digitsCounted = 0;\n        for (const char of formattedValue) {\n          newCursorPos++;\n          if (/\\d/.test(char)) digitsCounted++;\n          if (digitsCounted >= digitsBeforeCursor) break;\n        }\n        while (newCursorPos < formattedValue.length && formattedValue[newCursorPos] && /\\D/.test(formattedValue[newCursorPos] || '')) {\n          newCursorPos++;\n        }\n        input.setSelectionRange(newCursorPos, newCursorPos);\n      }\n\n      // Validar e atualizar estilo\n      const validation = validatePhoneFormat(formattedValue);\n\n      if (!digits) {\n        updateUI('', ''); // Limpar UI se n\u00E3o houver d\u00EDgitos\n      } else if (digits.length < 10) {\n        updateUI('#f1c40f', 'N\u00FAmero de telefone incompleto');\n      } else if (!validation.isValid) {\n        updateUI('red', 'DDD ou n\u00FAmero de telefone inv\u00E1lido');\n      } else if (validation.type === 'celular') {\n        updateUI('green', 'Celular v\u00E1lido');\n      } else if (validation.type === 'fixo') {\n        updateUI('green', 'Telefone fixo v\u00E1lido');\n      }\n    };\n\n    // Remove eventos anteriores e adiciona novos\n    $input.off('.phone').on('input.phone', formatOnInput);\n\n    // Executar valida\u00E7\u00E3o inicial se j\u00E1 houver valor\n    const currentValue = frm.doc[phoneField]?.toString();\n    if (currentValue) {\n      $input.trigger('input.phone');\n    }\n\n    // Resolve a Promise uma vez que a configura\u00E7\u00E3o inicial esteja conclu\u00EDda\n    resolve();\n  });\n};", "frappe.provide('agt.utils');\n\n// Temporary fix for TypeScript issues - use any type for agt.utils\ndeclare const agt: any;\n\nagt.utils.workflow_transition = async function(\n  form: any,\n  action: string,\n  callback?: ((f: any) => void) | ((f: any) => Promise<void>)\n) {\n  if (!form || !form.states?.frm || !action) {\n    console.error('workflow_transition: Par\u00E2metros inv\u00E1lidos.');\n    return;\n  }\n  \n  // set the workflow_action for use in form scripts\n  frappe.dom.freeze();\n  form.states.frm.selected_workflow_action = action;\n  form.states.frm.script_manager.trigger('before_workflow_action').then(async () => {\n    await frappe\n      .xcall('frappe.model.workflow.apply_workflow', {\n        doc: form.states.frm.doc,\n        action: action\n      })\n      .then((doc: any) => {\n        frappe.model.sync(doc);\n        form.states.frm.refresh();\n        form.states.frm.selected_workflow_action = null;\n        form.states.frm.script_manager.trigger('after_workflow_action');\n      })\n      .finally(async () => {\n        frappe.dom.unfreeze();\n        callback && (await callback(form));\n      });\n  });\n};\n\nagt.utils.update_workflow_state = async function(params: {\n  doctype: string;\n  docname: string;\n  workflow_state: string;\n  ignore_workflow_validation?: boolean;\n  callback?: () => Promise<void>;\n}) {\n  const { doctype, docname, workflow_state, ignore_workflow_validation, callback } = params;\n  return await frappe\n    .call({\n      method: 'update_workflow_state',\n      args: { doctype, docname, workflow_state, ignore_workflow_validation }\n    })\n    .then(async () => {\n      return await agt.utils.refresh_force().then(async (doc: any) => {\n        callback && (await callback());\n        return doc;\n      });\n    });\n};\n\nagt.utils.refresh_force = async function() {\n  if (!cur_frm?.doc?.doctype || !cur_frm?.doc?.name) {\n    console.error('refresh_force: cur_frm ou documento inv\u00E1lido');\n    return undefined;\n  }\n  \n  frappe.model.clear_doc(cur_frm.doc.doctype, cur_frm.doc.name);\n  return await agt.utils.doc.get_doc(cur_frm.doc.doctype, cur_frm.doc.name)\n    .then((doc: any) => {\n      if (cur_frm?.states?.frm?.refresh) {\n        cur_frm.states.frm.refresh(); // Refresh the form\n      }\n      return doc;\n    })\n    .catch((error: any) => {\n      console.error('Error refreshing document:', error);\n      return undefined;\n    });\n};\n\n// Validation functions (moved here to avoid circular dependencies)\nagt.utils.validate_cpf_regex = function(cpf: string): boolean {\n  if (!cpf || typeof cpf !== 'string') return false;\n  cpf = cpf.trim();\n  return /^(?!000\\.000\\.000\\-00)(\\d{3}\\.\\d{3}\\.\\d{3}\\-\\d{2})$/.test(cpf);\n};\n\nagt.utils.validate_cnpj_regex = function(cnpj: string): boolean {\n  if (!cnpj || typeof cnpj !== 'string') return false;\n  cnpj = cnpj.trim();\n  return /^(?!00\\.000\\.000\\/0000\\-00)(\\d{2}\\.\\d{3}\\.\\d{3}\\/\\d{4}\\-\\d{2})$/.test(cnpj);\n};\n\nagt.utils.validate_cpf = function(cpf: string): boolean {\n  const d = (cpf || '').replace(/\\D/g, '');\n  if (d.length !== 11 || /^(\\d)\\1+$/.test(d)) return false;\n  let sum = 0;\n  for (let i = 0; i < 9; i++) sum += +(d[i] || 0) * (10 - i);\n  let check = (sum * 10) % 11;\n  if (check === 10) check = 0;\n  if (check !== +(d[9] || 0)) return false;\n  sum = 0;\n  for (let i = 0; i < 10; i++) sum += +(d[i] || 0) * (11 - i);\n  check = (sum * 10) % 11;\n  if (check === 10) check = 0;\n  return check === +(d[10] || 0);\n};\n\nagt.utils.validate_cnpj = function(cnpj: string): boolean {\n  const d = (cnpj || '').replace(/\\D/g, '');\n  if (d.length !== 14 || /^(\\d)\\1+$/.test(d)) return false;\n  const calc = (base: string, weights: number[]) => base.split('').reduce((sum, n, i) => sum + +(n || 0) * (weights[i] || 0), 0);\n  const w1 = [5, 4, 3, 2, 9, 8, 7, 6, 5, 4, 3, 2];\n  const w2 = [6, ...w1];\n  let check = calc(d.slice(0, 12), w1) % 11;\n  let digit = check < 2 ? 0 : 11 - check;\n  if (digit !== +(d[12] || 0)) return false;\n  check = calc(d.slice(0, 13), w2) % 11;\n  digit = check < 2 ? 0 : 11 - check;\n  return digit === +(d[13] || 0);\n};\n\nagt.utils.validate_cnpj_existence = async function (cnpj: string): Promise<boolean> {\n  if (!cnpj || typeof cnpj !== 'string') return false;\n  \n  const digits = cnpj.replace(/\\D/g, '');\n  if (digits.length !== 14) return false;\n\n  try {\n    const response = await frappe.call({\n      method: 'check_cnpj',\n      args: { cnpj: digits }\n    });\n    const data = response?.message;\n    // Considera v\u00E1lido se n\u00E3o houver erro e o CNPJ retornado for igual ao consultado\n    return !!data && !!data.cnpj && data.cnpj.replace(/\\D/g, '') === digits;\n  } catch (error: any) {\n    console.error('Erro ao validar CNPJ:', error);\n    return false;\n  }\n};\n\nagt.utils.format_doc = function(doc: string, type?: string): string {\n  let digits = (doc || '').replace(/\\D/g, '');\n\n  const formatCpf = (d: string) => {\n    let formatted = d.slice(0, 11);\n    if (formatted.length > 3) formatted = formatted.replace(/^(\\d{3})(\\d)/, '$1.$2');\n    if (formatted.length > 6) formatted = formatted.replace(/^(\\d{3})\\.(\\d{3})(\\d)/, '$1.$2.$3');\n    if (formatted.length > 9) formatted = formatted.replace(/^(\\d{3})\\.(\\d{3})\\.(\\d{3})(\\d)/, '$1.$2.$3-$4');\n    return formatted;\n  };\n\n  const formatCnpj = (d: string) => {\n    let formatted = d.slice(0, 14);\n    if (formatted.length > 2) formatted = formatted.replace(/^(\\d{2})(\\d)/, '$1.$2');\n    if (formatted.length > 5) formatted = formatted.replace(/^(\\d{2})\\.(\\d{3})(\\d)/, '$1.$2.$3');\n    if (formatted.length > 8) formatted = formatted.replace(/^(\\d{2})\\.(\\d{3})\\.(\\d{3})(\\d)/, '$1.$2.$3/$4');\n    if (formatted.length > 12) formatted = formatted.replace(/^(\\d{2})\\.(\\d{3})\\.(\\d{3})\\/(\\d{4})(\\d)/, '$1.$2.$3/$4-$5');\n    return formatted;\n  };\n\n  if (type === 'Pessoa F\u00EDsica') {\n    return formatCpf(digits);\n  }\n  if (type === 'Pessoa Jur\u00EDdica') {\n    return formatCnpj(digits);\n  }\n  // Se n\u00E3o houver tipo, formata com base no comprimento\n  return digits.length < 12 ? formatCpf(digits) : formatCnpj(digits);\n};\n\n// Document ID validation function\nagt.utils.document_id = async function(frm: any, docField: string, typeField: string) {\n  const field = frm.fields_dict[docField];\n  if (!field?.$input) {\n    console.error(`document_id: O campo '${docField}' n\u00E3o foi encontrado ou n\u00E3o \u00E9 um campo de entrada v\u00E1lido.`);\n    return;\n  }\n  const $input = field.$input as any;\n\n  const setVisualStyle = (status: 'default' | 'warning' | 'error' | 'success') => {\n    let icon = '';\n    switch (status) {\n      case 'warning':\n        icon = '<i class=\"fa fa-exclamation-circle\" style=\"color:#f1c40f\"></i> ';\n        break;\n      case 'error':\n        icon = '<i class=\"fa fa-times-circle\" style=\"color:#e74c3c\"></i> ';\n        break;\n      case 'success':\n        icon = '<i class=\"fa fa-check-circle\" style=\"color:#27ae60\"></i> ';\n        break;\n      default:\n        icon = '';\n    }\n    return icon;\n  };\n\n  const updateUI = (color: string, message: string) => {\n    let status: 'default' | 'warning' | 'error' | 'success' = 'default';\n    if (color === '#f1c40f') status = 'warning';\n    else if (color === 'red' || color === '#e74c3c') status = 'error';\n    else if (color === 'green' || color === '#27ae60') status = 'success';\n    const icon = setVisualStyle(status);\n    field.set_description(icon + (message ? `<b style='color:${color}'>${message}</b>` : ''));\n  };\n\n  const validateAndStyle = () => {\n    const value = ($input.val() || '') as string;\n    const digits = value.replace(/\\D/g, '');\n    const docType = typeField ? frm.doc[typeField] : null;\n\n    // Make the field read-only and hidden if the document type is not valid  \n    if (docType && docType !== 'Pessoa F\u00EDsica' && docType !== 'Pessoa Jur\u00EDdica') {\n      frm.set_df_property(docField, 'read_only', 1);\n      frm.set_df_property(docField, 'hidden', 1);\n      updateUI('#f1c40f', 'Selecione o tipo de documento antes de preencher.');\n      return;\n    } else {\n      frm.set_df_property(docField, 'read_only', 0);\n      frm.set_df_property(docField, 'hidden', 0);\n    }\n\n    if (!digits) {\n      updateUI('', ''); // Clear the UI if no digits are present\n      return;\n    }\n\n    // { CPF logic }\n    if (docType === 'Pessoa F\u00EDsica') {\n      if (digits.length < 11) {\n        updateUI('#f1c40f', 'CPF incompleto');\n      } else {\n        if (agt.utils.validate_cpf(digits)) {\n          updateUI('green', 'CPF v\u00E1lido');\n        } else {\n          updateUI('red', 'CPF inv\u00E1lido. Favor corrigir.');\n        }\n      }\n      return;\n    }\n\n    // { CNPJ logic }\n    if (docType === 'Pessoa Jur\u00EDdica') {\n      if (digits.length < 14) {\n        updateUI('#f1c40f', 'CNPJ incompleto');\n      } else {\n        if (agt.utils.validate_cnpj(digits)) {\n          updateUI('#27ae60', 'CNPJ v\u00E1lido sintaticamente. Verificando exist\u00EAncia...');\n          agt.utils.validate_cnpj_existence(digits).then((exists: any) => {\n            if (exists) {\n              updateUI('green', 'CNPJ existe e est\u00E1 ativo');\n            } else {\n              updateUI('red', 'CNPJ n\u00E3o encontrado na base nacional');\n            }\n          });\n        } else {\n          updateUI('red', 'CNPJ inv\u00E1lido. Favor corrigir.');\n        }\n      }\n      return;\n    }\n\n    // { Ambiguous logic }\n    if (docType === null) {\n      if (digits.length < 11 || (digits.length > 11 && digits.length < 14)) {\n        updateUI('#f1c40f', 'CPF ou CNPJ incompleto.');\n      } else if (digits.length === 11) {\n        if (agt.utils.validate_cpf(digits)) {\n          updateUI('green', 'CPF v\u00E1lido');\n        } else {\n          updateUI('red', 'CPF ou CNPJ inv\u00E1lido ou incompleto');\n        }\n      } else if (digits.length >= 14) {\n        const cnpDigits = digits.slice(0, 14);\n        if (agt.utils.validate_cnpj(cnpDigits)) {\n          updateUI('green', 'CNPJ v\u00E1lido');\n        } else {\n          updateUI('red', 'CNPJ inv\u00E1lido. Favor corrigir.');\n        }\n      }\n    }\n  };\n\n  const formatOnInput = (e: any) => {\n    const input = e.target as HTMLInputElement;\n    const originalValue = input.value;\n    const docType = typeField ? frm.doc[typeField] : null;\n\n    // Store the cursor position before formatting\n    const originalPos = input.selectionStart || 0;\n    const digitsBeforeCursor = (originalValue.slice(0, originalPos).replace(/\\D/g, '')).length;\n\n    // Extract only digits and limit length based on document type\n    let digits = originalValue.replace(/\\D/g, '');\n    const maxLength = docType === 'Pessoa Jur\u00EDdica' ? 14 : (docType === 'Pessoa F\u00EDsica' ? 11 : 14);\n    if (digits.length > maxLength) {\n      digits = digits.slice(0, maxLength);\n    }\n\n    const formatCpf = (d: string) => d.replace(/(\\d{3})(\\d)/, '$1.$2').replace(/(\\d{3})\\.(\\d{3})(\\d)/, '$1.$2.$3').replace(/(\\d{3})\\.(\\d{3})\\.(\\d{3})(\\d{1,2})/, '$1.$2.$3-$4');\n    const formatCnpj = (d: string) => d.replace(/(\\d{2})(\\d)/, '$1.$2').replace(/(\\d{2})\\.(\\d{3})(\\d)/, '$1.$2.$3').replace(/(\\d{2})\\.(\\d{3})\\.(\\d{3})(\\d)/, '$1.$2.$3/$4').replace(/(\\d{2})\\.(\\d{3})\\.(\\d{3})\\/(\\d{4})(\\d)/, '$1.$2.$3/$4-$5');\n\n    let formattedValue = digits;\n    if (docType === 'Pessoa F\u00EDsica') {\n      formattedValue = formatCpf(digits);\n    } else if (docType === 'Pessoa Jur\u00EDdica') {\n      formattedValue = formatCnpj(digits);\n    } else {\n      formattedValue = digits.length > 11 ? formatCnpj(digits) : formatCpf(digits);\n    }\n\n    // Apply the formatted value and adjust the cursor\n    if (originalValue !== formattedValue) {\n      input.value = formattedValue;\n      frm.doc[docField] = formattedValue;\n\n      // Recalcula a nova posi\u00E7\u00E3o do cursor\n      let newCursorPos = 0;\n      let digitsCounted = 0;\n      for (const char of formattedValue) {\n        newCursorPos++;\n        if (/\\d/.test(char)) digitsCounted++;\n        if (digitsCounted >= digitsBeforeCursor) break;\n      }\n      while (newCursorPos < formattedValue.length && formattedValue[newCursorPos] && /\\D/.test(formattedValue[newCursorPos] || '')) {\n        newCursorPos++;\n      }\n      input.setSelectionRange(newCursorPos, newCursorPos);\n    }\n\n    // Performs validation for real-time feedback\n    validateAndStyle();\n  };\n\n  // Attach events to the input field\n  $input.off('.cpfcnpj').on('input.cpfcnpj', formatOnInput);\n\n  // Revalidate if the type field changes\n  if (typeField && frm.fields_dict[typeField]?.$input) {\n    frm.fields_dict[typeField].$input.off(`.cpfcnpjtype_${docField}`).on(`change.cpfcnpjtype_${docField}`, () => {\n      validateAndStyle(); // Directly call the validation/style function\n      $input.trigger('input.cpfcnpj'); // Optional: keep formatting if needed\n    });\n  }\n  // Perform initial validation\n  validateAndStyle();\n};\n\nagt.utils.redirect_by_ref = function(ref?: string, title?: string, message?: string, indicator?: string, url?: string, delay = 3000, newTab = true) {\n  if (!ref || !url) {\n    console.error('redirect_by_ref: ref e url s\u00E3o obrigat\u00F3rios');\n    return;\n  }\n\n  frappe.msgprint({\n    title: title || 'Redirecionando...',\n    message: message ?? \"\",\n    indicator: indicator || 'blue'\n  });\n\n  setTimeout(() => {\n    if (url) {\n      if (newTab) {\n        window.open(url, '_blank');\n      } else {\n        window.location.href = url;\n      }\n    }\n  }, delay);\n};\n\nagt.utils.build_doc_url = function(doctype: string, docname: string): string {\n  const doctypeSlug = doctype\n    .replace(/([a-z])([A-Z])/g, '$1-$2')\n    .replace(/\\s+/g, '-')\n    .replace(/_/g, '-')\n    .toLowerCase();\n  return `${window.location.origin}/app/${doctypeSlug}/${encodeURIComponent(docname)}`;\n};\n\nagt.utils.redirect_after_create_doc = function(success: boolean, url: string, docname: string, doctype: string): void {\n  if (success) {\n    frappe.msgprint({\n      title: \"Redirecionando...\",\n      message: `${doctype} criado com sucesso! Voc\u00EA ser\u00E1 direcionado para o documento (${docname}).`,\n      indicator: \"green\"\n    });\n  } else {\n    frappe.msgprint({\n      title: \"Redirecionando...\",\n      message: `Voc\u00EA ser\u00E1 direcionado para o documento j\u00E1 existente (${docname}).`,\n      indicator: \"blue\"\n    });\n  }\n  setTimeout(() => {\n    window.location.href = url;\n  }, 2000);\n};\n\nagt.utils.get_item_info = async function(item_name: string, sn?: string) {\n  if (!item_name || typeof item_name !== 'string') {\n    console.error('get_item_info: item_name \u00E9 obrigat\u00F3rio');\n    return;\n  }\n  \n  const all_items = await frappe.db\n    .get_list('Item', {\n      fields: ['item_code', 'custom_mppt', 'item_name'],\n    })\n    .catch((e: any) => {\n      console.error('Erro ao buscar itens:', e);\n      return null;\n    });\n\n  if (!all_items || !all_items.length) return;\n\n  // Busca flex\u00EDvel usando normalize_text apenas com item_name\n  const normalizedInput = agt.utils.text.normalize(item_name);\n  const filtered_items = all_items.filter((item: any) =>\n    agt.utils.text.normalize(item.item_name) === normalizedInput\n  );\n\n  if (!filtered_items.length) return;\n  // Se s\u00F3 existe um MPPT, retorna direto\n  const uniqueMppts = [...new Set(filtered_items.map((item: any) => item.custom_mppt))];\n  if (uniqueMppts.length === 1) return filtered_items[0];\n\n  // Se h\u00E1 mais de um MPPT, mostra o di\u00E1logo para sele\u00E7\u00E3o\n  const dialog_title = `Selecione a quantidade de MPPTs (${item_name}${sn ? ` - ${sn}` : ''})`;\n  return new Promise<any>(resolve => {\n    agt.utils.dialog.load({\n      title: dialog_title,\n      fields: [\n        {\n          fieldname: 'mppt',\n          label: 'MPPT',\n          fieldtype: 'Select',\n          options: uniqueMppts,\n          reqd: true\n        }\n      ],\n      static: false,\n      draggable: false,\n      lockClose: true,\n      primary_action: async function (values: any) {\n        const mppt = values.mppt;\n        if (!mppt) return;\n        const item = filtered_items.find((item: any) => item.custom_mppt === mppt);\n        agt.utils.dialog.close_by_title(dialog_title);\n        resolve(item); // Resolve o item selecionado\n      }\n    });\n  });\n};\n\nagt.utils.get_growatt_sn_info = async function(serial_no: string) {\n  if (!serial_no || typeof serial_no !== 'string') {\n    console.error('get_growatt_sn_info: serial_no \u00E9 obrigat\u00F3rio');\n    return undefined;\n  }\n  \n  try {\n    const sn = await frappe.call({\n      method: 'get_growatt_sn_info',\n      args: { deviceSN: serial_no }\n    });\n    const fail = !sn || !sn.message?.code || sn.message.code !== 200;\n    if (fail) return undefined;\n    return sn.message;\n  } catch (error: any) {\n    console.error('Erro ao buscar informa\u00E7\u00F5es do SN Growatt:', error);\n    return undefined;\n  }\n};\n\nagt.utils.validate_serial_number = function(sn: string, type?: 'inverter' | 'battery' | 'ev_charger' | 'transformer' | 'smart_meter' | 'smart_energy_manager' | 'other'): boolean {\n  if (!sn || typeof sn !== 'string') return false;\n\n  sn = sn.trim().toUpperCase();\n\n  const sn_regex = /^[A-Z0-9][A-Z][A-Z0-9]([A-Z0-9]{7}|[A-Z0-9]{13})$/;\n  const iv_sn_regex = /^[A-Z0-9]{3}[A-Z0-9]{7}$/;\n  const other_sn_regex = /^[A-Z0-9]{3}[A-Z0-9]{13}$/;\n\n  let output = false;\n  if (type === 'inverter') {\n    output = iv_sn_regex.test(sn);\n  } else if (type === 'battery' || type === 'ev_charger') {\n    output = other_sn_regex.test(sn);\n  } else {\n    output = sn_regex.test(sn);\n  }\n  return output;\n};\n\nagt.utils.get_value_from_any_doc = async function(\n  frm: any,\n  doctype: string,\n  docnameField: string,\n  fieldName: string\n): Promise<any> {\n  const docname = frm.doc[docnameField];\n  if (!docname) return null;\n  try {\n    const result = await frappe.db.get_doc(doctype, docname);\n    return result?.[fieldName] ?? null;\n  } catch (e) {\n    console.error(`Erro ao buscar campo ${fieldName} do ${doctype}:`, e);\n    return null;\n  }\n};", "import { JoinStep } from \"@anygridtech/frappe-agt-types/agt/client/utils/db\";\n\nfrappe.provide('agt.db');\n\nagt.db.filter_join = async function <Steps extends readonly JoinStep[]>(\n  steps: Steps\n): Promise<\n  Steps extends [...any, infer Last]\n  ? Last extends JoinStep<infer T>\n  ? T[]\n  : any[]\n  : any[]\n> {\n  // Inferir o tipo do resultado final\n  type Result = Steps extends [...any, infer Last]\n    ? Last extends JoinStep<infer T>\n    ? T[]\n    : any[]\n    : any[];\n\n  let results: Result = [] as unknown as Result;\n\n  for (let i = 0; i < steps.length; i++) {\n    const step = steps[i];\n    if (!step) continue;\n\n    const filters = { ...step.filters };\n    if (i > 0 && step.joinOn && (results as any[]).length > 0) {\n      const joinOn = step.joinOn;\n      const joinValues = (results as any[]).map(item => item[joinOn.sourceField]);\n      filters[joinOn.targetField] = [\"in\", joinValues];\n    }\n\n    if (step.joinOn && (results as any[]).length === 0) {\n      console.warn(`No results found for step ${i + 1}. Skipping further joins.`);\n      break;\n    }\n\n    const response = await frappe.call({\n      method: \"backend_get_all\",\n      args: {\n        doctype: step.doctype,\n        filters,\n        fields: step.fields,\n      }\n    });\n\n    results = (response.message.data || []) as Result;\n  }\n\n  return results;\n};", "frappe.provide('agt.utils.dialog');\n\nagt.utils.dialog.created = [];\n\nagt.utils.dialog.load = function(diagConfig: any) {\n  const dialog = new frappe.ui.Dialog(diagConfig);\n\n  // Adiciona ao array de di\u00E1logos antes de mostrar\n  agt.utils.dialog.created.push(dialog);\n\n  // Configura evento para quando o di\u00E1logo fechar (via \"\u00D7\" ou ESC)\n  $(dialog['wrapper']).on('hidden.bs.modal', () => {\n    const index = agt.utils.dialog.created.indexOf(dialog);\n    if (index > -1) {\n      agt.utils.dialog.created.splice(index, 1);\n      agt.utils.dialog.refresh_dialog_stacking();\n    }\n  });\n\n  // Mostra o di\u00E1logo\n  dialog.show();\n\n  // Aplica z-index ap\u00F3s o di\u00E1logo estar vis\u00EDvel\n  setTimeout(() => agt.utils.dialog.refresh_dialog_stacking(), 50);\n\n  return dialog;\n};\n\nagt.utils.dialog.close_all = function() {\n  // Captura os di\u00E1logos antes de fech\u00E1-los\n  const dialogs = [...agt.utils.dialog.created];\n\n  // Fecha cada di\u00E1logo\n  dialogs.forEach((dialog: any) => {\n    if (dialog) {\n      dialog.hide();\n      // Remova o backdrop manualmente\n      const $backdrop = $(dialog['wrapper']).data(\"bs.modal\")?.$backdrop;\n      $backdrop?.remove();\n    }\n  });\n\n  // Limpa o array\n  agt.utils.dialog.created = [];\n};\n\nagt.utils.dialog.close_by_title = function(title: string) {\n  const dialogIndex = agt.utils.dialog.created.findIndex((d: any) => d.title === title);\n  if (dialogIndex >= 0) {\n    const dialog = agt.utils.dialog.created[dialogIndex];\n    if (dialog) {\n      dialog.hide();\n\n      // Remova o backdrop manualmente\n      const $backdrop = $(dialog['wrapper']).data(\"bs.modal\")?.$backdrop;\n      $backdrop?.remove();\n\n      // Remove o di\u00E1logo da lista\n      agt.utils.dialog.created.splice(dialogIndex, 1);\n\n      // Reaplica o z-index para os di\u00E1logos restantes\n      agt.utils.dialog.refresh_dialog_stacking();\n    }\n  }\n};\n\nagt.utils.dialog.show_debugger_alert = function(_frm: any, message: string, indicator: string, timeout: number = 10) {\n  if (frappe.user.has_role(['IT', 'Administrator', 'System Manager'])) {\n    frappe.show_alert({ message: __(message), indicator: indicator }, timeout);\n  }\n};\n\nagt.utils.dialog.refresh_dialog_stacking = function() {\n  if (typeof $ === 'undefined') {\n    console.error('jQuery is not loaded. Unable to refresh dialog stacking.');\n    return;\n  }\n\n  // Base z-index para modal e backdrop\n  const baseModalIndex = 1051;\n  const baseBackdropIndex = 1050;\n\n  // Para cada di\u00E1logo em ordem de cria\u00E7\u00E3o\n  agt.utils.dialog.created.forEach((dialog: any, index: number) => {\n    // Verifica se o di\u00E1logo est\u00E1 vis\u00EDvel\n    if ($(dialog['wrapper']).is(':visible')) {\n      // Configura z-index com incremento para cada di\u00E1logo\n      const zIndex = baseModalIndex + (index * 2);\n\n      // Aplica ao modal\n      $(dialog['wrapper']).css('z-index', zIndex);\n\n      // Encontra e aplica ao backdrop correspondente\n      const modalId = $(dialog['wrapper']).attr('id');\n      $(`.modal-backdrop[data-modal-id=\"${modalId}\"]`).css('z-index', baseBackdropIndex + (index * 2));\n\n      // Associa ID do modal ao backdrop para facilitar a correspond\u00EAncia\n      const $backdrop = $(dialog['wrapper']).data(\"bs.modal\")?.$backdrop;\n      if ($backdrop && !$backdrop.attr('data-modal-id')) {\n        $backdrop.attr('data-modal-id', modalId);\n      }\n    }\n  });\n};", "frappe.provide('agt.utils.doc');\n\nagt.utils.doc.create_doc = async function(\n  doctype: string,\n  fields_target: string[],\n  fields_dict: Record<string, any>\n): Promise<string | undefined> {\n  const meta = await agt.utils.doc.get_doc_meta(doctype);\n  if (!meta) {\n    frappe.throw(`Could not fetch meta for doctype: ${doctype}`);\n    return;\n  }\n\n  const fields_record = Object.entries(fields_dict).reduce((acc, [k, v]) => {\n    if (typeof v.value === \"number\" || typeof v.value === \"string\") {\n      acc[k] = v.value;\n    }\n    return acc;\n  }, {} as Record<string, string | number>);\n\n  const valid_fields = meta.fields.map((field: any) => field.fieldname);\n\n  // Novo formato obrigat\u00F3rio: fields_target \u00E9 um array de nomes de campos a copiar do cur_frm.doc\n  for (const targetField of fields_target) {\n    if (!valid_fields.includes(targetField)) continue;\n\n    let value: any;\n    if (targetField === \"docname\" && cur_frm?.docname) {\n      value = cur_frm.docname;\n    } else if (cur_frm?.doc && targetField in cur_frm.doc) {\n      value = (cur_frm.doc as any)[targetField];\n    }\n\n    if (value !== undefined) {\n      fields_record[targetField] = value;\n    }\n  }\n\n  // Filtra apenas fields v\u00E1lidos\n  const valid_updates: Record<string, any> = {};\n  for (const [fieldname, field] of Object.entries(fields_record)) {\n    if (!valid_fields.includes(fieldname)) continue;\n    // Simple validation: skip empty/null/undefined values\n    if (field === undefined || field === null || field === '') continue;\n    valid_updates[fieldname] = field;\n  }\n\n  if (Object.keys(valid_updates).length === 0) {\n    frappe.throw(`No valid fields to create the document: ${doctype}`);\n    return;\n  }\n\n  // Cria doc novo\n  const doc = frappe.model.get_new_doc(doctype);\n\n  // Aplica atualiza\u00E7\u00F5es v\u00E1lidas\n  for (const [name, value] of Object.entries(valid_updates)) {\n    if (name === \"workflow_state\" || name === \"naming_series\") continue;\n    doc[name] = value;\n  }\n\n  // Salva doc\n  const r1 = await frappe.db.insert(doc).catch((e: any) => console.error(e));\n  return r1?.name;\n};\n\nagt.utils.doc.update_doc = async function(\n  doctype: string,\n  docname: string,\n  fields_record: Record<string, any>,\n  retryCount = 0\n): Promise<void> {\n  const maxRetries = 3; // Limit retries to prevent infinite loops\n  if (retryCount >= maxRetries) {\n    console.error(`Max retries (${maxRetries}) reached. Aborting update.`);\n    return;\n  }\n  try {\n    // Fetch the latest document\n    const doc = await frappe.db.get_doc(doctype, docname).catch((e: any) => console.error(e));\n    if (!doc) {\n      console.error(`Document '${docname}' not found.`);\n      return;\n    }\n\n    // Determine valid updates\n    const valid_updates: Record<string, any> = {};\n    const ignore_fields = ['workflow_state', 'naming_series', 'creation', 'doctype', 'modified', 'name', 'owner'];\n    for (const [f, v] of Object.entries(fields_record)) {\n      if (ignore_fields.includes(f) && doctype !== 'Serial No') continue;\n      if (doc[f] === undefined) continue;\n      if (doc[f] === v) continue;\n      if (doc[f] === null && v === '') continue;\n      if (doc[f] === '' && v === null) continue;\n      console.log(`[${doctype} - ${docname}] Setting ${f} to ${v}`);\n      doc[f] = v;\n      valid_updates[f] = v;\n    }\n\n    if (Object.keys(valid_updates).length === 0) {\n      console.log(`[${doctype} - ${docname}] No valid fields to update`);\n      return;\n    }\n\n    // Save the updated document\n    await frappe.call({\n      method: 'frappe.client.save',\n      args: { doc }\n    });\n\n    if (doctype === cur_frm.doctype && docname === cur_frm.docname) {\n      // Fetch the latest version of the document from the server\n      const updatedDoc = (await frappe\n        .call({\n          method: 'frappe.client.get',\n          args: { doctype, name: docname }\n        })\n        .then(({ message }: any) => message)) as any;\n\n      frappe.model.sync([updatedDoc]);\n\n      cur_frm.states.frm.refresh();\n    }\n\n    console.log(`Document '${docname}' updated successfully.`);\n  } catch (error) {\n    // Check for timestamp mismatch\n    if ((error as unknown as any)?.message?.includes('Document has been modified after you have opened it')) {\n      console.warn('Timestamp mismatch detected. Refetching document...');\n      return await agt.utils.doc.update_doc(doctype, docname, fields_record, retryCount + 1);\n    } else {\n      console.error(`Error saving document '${docname}':`, error);\n    }\n  }\n};\n\nagt.utils.doc.get_doc = async function(doctype: string, docname: string) {\n  return await frappe\n    .call({\n      method: 'frappe.client.get',\n      args: { doctype, name: docname }\n    })\n    .then(async (doc: any) => {\n      // Update locals manually\n      frappe.model.clear_doc(doctype, docname); // Clears old cache\n      frappe.model.sync([doc.message]); // Syncs the fresh document\n      cur_frm.states.frm.refresh(); // Refresh the form\n      return doc.message; // Return the latest document\n    });\n};\n\nagt.utils.doc.share_doc = async function(doctype: string, docname: string, users: any[]) {\n  const shared_users = (await frappe\n    .call({\n      method: 'frappe.share.get_users',\n      args: { doctype: doctype, name: docname }\n    })\n    .then(({ message }: any) => message)) as any[];\n  for (const user of users) {\n    const shared = shared_users.find(u => u.user === user.user);\n    if (shared?.read === user.read && shared?.write === user.write && shared?.share === user.share) {\n      console.log(`Document '${docname}' already shared with user '${user.user}'`);\n      continue;\n    }\n    await frappe\n      .call({\n        method: 'frappe.share.add',\n        args: {\n          doctype: doctype,\n          name: docname,\n          user: user.user,\n          read: user.read,\n          write: user.write,\n          share: user.share,\n          owner: user.owner || frappe.session.user_email\n        }\n      })\n      .then(() => console.log(`Document '${docname}' shared with user '${user.user}'`));\n  }\n};\n\nagt.utils.doc.get_doc_meta = async function(doctype: string) {\n  await frappe.model.with_doctype(doctype);\n  return frappe.get_meta(doctype);\n};", "frappe.provide('agt.utils.form');\nfrappe.provide('agt.utils.form.field');\n\nagt.utils.form.field.is_empty = function(value: string): boolean {\n  if (!value) return true;\n  const text = value.replace(/<[^>]*>/g, '').replace(/&nbsp;/g, '').trim();\n  return text === '';\n};\n\nagt.utils.form.field.set_properties = function(frm: any, configs: Record<string, any>): void {\n  Object.entries(configs).forEach(([fieldname, opts]) => {\n    if (opts.hidden !== undefined) {\n      const $el = frm.$wrapper.find(`[data-fieldname='${fieldname}']`);\n      $el.toggle(!opts.hidden);\n    }\n    if (opts.readonly !== undefined) {\n      frm.set_df_property(fieldname, 'read_only', opts.readonly ? 1 : 0);\n    }\n    if (opts.reqd !== undefined) {\n      frm.set_df_property(fieldname, 'reqd', opts.reqd ? 1 : 0);\n    }\n    if (opts.label !== undefined) {\n      frm.set_df_property(fieldname, 'label', opts.label);\n    }\n    if (opts.description !== undefined) {\n      frm.set_df_property(fieldname, 'description', opts.description);\n    }\n  });\n  frm.refresh_fields();\n};\n\nagt.utils.form.field.get_js_visible_fields = function(form: any) {\n  const visible_fields: any[] = [];\n  for (let field of Object.values(form.fields_dict) as any[]) {\n    if (['Table', 'Section Break', 'Column Break', 'HTML', 'Fold'].includes(field.df.fieldtype)) continue;\n    if (!field.df.depends_on) continue;\n    const depends_on_json_fnc = field.df.depends_on.replace('eval:', '') as string;\n    const is_visible = frappe.utils.eval(depends_on_json_fnc, {\n      doc: form.doc\n    });\n    if (is_visible) visible_fields.push(field);\n  }\n  return visible_fields;\n};\n\nagt.utils.form.field.validate_js_visible_fields = function(form: any, workflow_state: string) {\n  const js_visible_fields = agt.utils.form.field.get_js_visible_fields(form);\n  const title = __('Aten\u00E7\u00E3o!');\n  const indicator = 'red';\n  function validate_js_visible_fields_msg(fields: any[]) {\n    const throw_html: string[] = [];\n    for (let field of fields as any[]) {\n      throw_html.push(`<li>${field.df.label}</li>`);\n    }\n    const msg = `<p>${__('\u26A0\uFE0F Os campos abaixo s\u00E3o obrigat\u00F3rios: ')}</p>` + `<ul>${throw_html.join('')}</ul>`;\n    return msg;\n  }\n  const throw_error = () => {\n    if (workflow_state !== form.doc.workflow_state) return;\n    if (!js_visible_fields.length) return;\n    const message = validate_js_visible_fields_msg(js_visible_fields);\n    frappe.throw({ title, message, indicator });\n  };\n  const msgprint = () => {\n    if (workflow_state !== form.doc.workflow_state) return;\n    if (!js_visible_fields.length) return;\n    const message = validate_js_visible_fields_msg(js_visible_fields);\n    frappe.msgprint({ title, message, indicator });\n  };\n  return { throw_error, msgprint };\n};\n\nagt.utils.form.field.turn_into_link = function(frm: any, fieldName: string, docType: string) {\n  const field = frm.fields_dict[fieldName];\n  if (field && field.df.read_only && field.$wrapper) {\n    const $wrapper = field.$wrapper;\n    $wrapper.css(\"position\", \"relative\");\n    $wrapper.find(\".serial-link-mask\").remove();\n    $wrapper.append(\n      `<a class=\"serial-link-mask\" href=\"/app/${docType}/${encodeURIComponent(frm.doc[fieldName])}\" target=\"_blank\"\n        style=\"position:absolute;top:0;left:0;width:100%;height:100%;opacity:0;z-index:10;cursor:pointer;\"></a>`\n    );\n  }\n};\n\nagt.utils.form.mirror_checklist_table = async function(form: any, doctype: string, tableField: string, childname: string, docname: string, workflowStateField?: string) {\n  const name = form.doc.name;\n  // Fetch remote records with the additional workflow_state field if necessary\n  const fields = ['name'];\n  if (workflowStateField) fields.push('workflow_state');\n\n  const remote = await frappe.db.get_list(doctype, {\n    filters: { [childname]: name },\n    fields: fields\n  }).catch((e: any) => { console.error(`Error fetching ${doctype}:`, e); return []; });\n\n  const currentTable = (form.doc[tableField] || []) as any[];\n\n  // Check for differences between the current table and remote data, including workflow_state if necessary\n  let needsUpdate = !await agt.utils.table.is_sync(currentTable, remote, docname, workflowStateField);\n\n  // If there are no differences, do nothing\n  if (!needsUpdate) {\n    console.log(`Tabela '${tableField}' j\u00E1 est\u00E1 sincronizada.`);\n    return;\n  }\n\n  // Update the table with the new data\n  form.doc[tableField] = remote.map((item: any) => {\n    const row = { [docname]: item.name };\n    if (workflowStateField && item.workflow_state) {\n      row[workflowStateField] = item.workflow_state;\n    }\n    return row;\n  });\n  form.dirty();\n  form.refresh_field(tableField);\n  await form.save();\n  console.log(`Tabela '${tableField}' sincronizada.`);\n};\n\nagt.utils.form.assign_parent_doc_name = function(_form: any) {\n  // if (!form?.doc || form.doc.__islocal) return;\n\n  // const meta = frappe.get_meta?.(form.doc.doctype);\n  // const hasField = meta?.fields?.some(f => f.fieldname === \"ref_naming_series\");\n\n  // if (hasField && !form.doc.ref_naming_series && form.doc.name) {\n  //   form.set_value(\"ref_naming_series\", form.doc.name);\n  // }\n};\n\nagt.utils.form.adjust_html_elements = function(form: any, options: any): void {\n  // if (!form?.doc || form.doc.__islocal) return;\n  if (!form?.doc) return;\n\n  const elementsToRemove = {\n    removeTabs: '.form-tabs-list',\n    removeNavFormsTabs: '.nav.form-tabs',\n    removeSidebar: '.col-lg-2.layout-side-section',\n    removeAssignments: '.form-assignments',\n    removeAssignmentsButton: '.button.add-assignments-btn',\n    removeAttachments: '.form-attachments',\n    removeAttachmentsButton: '.button.add-attachments-btn',\n    removeShared: '.form-shared',\n    removeTags: '.form-tags',\n    removeSidebarStats: '.form-sidebar-stats',\n    removeSidebarMenu: '.list-unstyled.sidebar-menu.text-muted',\n    removeSidebarReset: 'button.btn-reset.sidebar-toggle-btn',\n    removeSidebarToggle: 'span.sidebar-toggle-btn',\n    removeActivityBar: '.form-footer',\n  };\n\n  Object.entries(elementsToRemove).forEach(([option, selector]) => {\n    if (options[option as keyof typeof options]) {\n      const el = document.querySelector(selector);\n      if (el) {\n        (el as HTMLElement).style.display = 'none';\n        el.remove();\n      }\n    }\n  });\n  if (options.removeTabs && !document.querySelector('.form-tabs-list')) {\n    document.querySelector('.form-layout')?.setAttribute('style', 'border-top: none');\n  }\n};\n\nagt.utils.form.render_doc_fields_table = async function(\n  wrapper: any,\n  docOrRows: any,\n  fields: any[],\n  meta?: any\n): Promise<void> {\n  if (!wrapper || !docOrRows || !fields?.length) {\n    console.error('[render_doc_fields_table] Invalid arguments!');\n    return;\n  }\n  const isTable = Array.isArray(docOrRows) || (\n    typeof docOrRows === 'object' && docOrRows !== null && 'length' in docOrRows && typeof (docOrRows as any).length === 'number'\n  );\n  const arr: Record<string, unknown>[] = isTable\n    ? Array.isArray(docOrRows)\n      ? (docOrRows as unknown[]).filter((el): el is Record<string, unknown> => typeof el === 'object' && el !== null)\n      : Array.from(docOrRows as any).filter((el: any): el is Record<string, unknown> => typeof el === 'object' && el !== null)\n    : [];\n  if (!meta) {\n    const doctype = isTable && arr.length > 0 ? arr[0]?.['doctype'] : (docOrRows as any)?.['doctype'];\n    if (doctype) meta = await frappe.get_meta?.(doctype as string);\n  }\n  // HTML escape helper to prevent XSS\n  const escapeHtml = (value: unknown): string => {\n    if (value === null || value === undefined) return '';\n    const str = String(value);\n    return str\n      .replace(/&/g, '&amp;')\n      .replace(/</g, '&lt;')\n      .replace(/>/g, '&gt;')\n      .replace(/\"/g, '&quot;')\n      .replace(/'/g, '&#x27;');\n  };\n\n  const getFieldMeta = (field: { fieldname: string; label?: string }) => {\n    const metaField = meta?.fields?.find((f: any) => f.fieldname === field.fieldname);\n    return {\n      label: field.label || metaField?.label || field.fieldname,\n      fieldtype: metaField?.fieldtype || 'Data',\n      options: metaField?.options\n    };\n  };\n  const autoFormat = (value: unknown, fieldtype: string, options?: unknown): string => {\n    if (value === null || value === undefined || value === '') return '<span class=\"text-muted\">\u2014</span>';\n    switch (fieldtype) {\n      case 'Link':\n        if (options && value != null) {\n          const slug = String(options).toLowerCase().replace(/\\s+/g, '-');\n          const escapedValue = escapeHtml(value);\n          return `<a href=\"/app/${escapeHtml(slug)}/${encodeURIComponent(String(value))}\" target=\"_blank\">${escapedValue}</a>`;\n        }\n        return escapeHtml(value);\n      case 'Select':\n        return `<span class=\"badge badge-light\">${escapeHtml(value)}</span>`;\n      case 'Date':\n      case 'Datetime':\n        const dateValue = frappe?.datetime?.str_to_user ? frappe.datetime.str_to_user(value as string) : String(value);\n        return escapeHtml(dateValue);\n      case 'Currency':\n      case 'Float':\n      case 'Int':\n        const formattedValue = (window as any).frappe?.format_value ? (window as any).frappe.format_value(value, { fieldtype }) : String(value);\n        return escapeHtml(formattedValue);\n      case 'Check':\n        return value ? '<span class=\"text-success\">\u2713 Sim</span>' : '<span class=\"text-danger\">\u2717 N\u00E3o</span>';\n      default:\n        return escapeHtml(value);\n    }\n  };\n  let rows = '';\n  let thead = '';\n  if (isTable) {\n    if (arr.length === 0) {\n      rows = `<tr><td colspan=\"${fields.length}\" class=\"text-center text-muted\">Nenhum dado encontrado.</td></tr>`;\n    } else {\n      rows = arr.map(row =>\n        '<tr>' + fields.map(field => {\n          const metaF = getFieldMeta(field);\n          const value = row[field.fieldname];\n          const displayValue = field.formatter ? field.formatter(value, row, metaF) : autoFormat(value, metaF.fieldtype, metaF.options);\n          return `<td${metaF.fieldtype === 'Link' ? ' data-debug-link=\"true\"' : ''}>${displayValue}</td>`;\n        }).join('') + '</tr>'\n      ).join('');\n      thead = '<tr>' + fields.map(field => {\n        const metaF = getFieldMeta(field);\n        const label = field.label || metaF.label || field.fieldname;\n        return `<th class=\"text-muted\">${escapeHtml(label)}</th>`;\n      }).join('') + '</tr>';\n    }\n  } else {\n    rows = fields.map(field => {\n      const metaF = getFieldMeta(field);\n      const value = (docOrRows as Record<string, unknown>)[field.fieldname];\n      const displayValue = field.formatter ? field.formatter(value, docOrRows as Record<string, unknown>, metaF) : autoFormat(value, metaF.fieldtype, metaF.options);\n      const label = field.label || metaF.label || field.fieldname;\n      return `<tr><td>${escapeHtml(label)}</td><td>${displayValue}</td></tr>`;\n    }).join('');\n  }\n  const table_html = `<div class=\"form-section\" style=\"margin-bottom: 16px;\">\n      <div class=\"table-responsive\" style=\"border: 1px solid var(--border-color); border-radius: var(--border-radius); overflow: hidden;\">\n        <table class=\"table table-bordered\" style=\"margin: 0; border: none;\">\n          ${thead ? `<thead class=\"table-header\">${thead}</thead>` : ''}\n          <tbody>\n            ${rows}\n          </tbody>\n        </table>\n      </div>\n    </div>`;\n  if (typeof (wrapper as { html: (html: string) => void }).html === 'function') {\n    (wrapper as { html: (html: string) => void }).html(table_html);\n  } else if (typeof window !== 'undefined' && (window as any).jQuery && wrapper instanceof (window as any).jQuery) {\n    (wrapper as any).html(table_html);\n  } else if (wrapper instanceof HTMLElement) {\n    wrapper.innerHTML = table_html;\n  }\n};\n\nagt.utils.form.set_button_primary_style = function(frm: any, fieldname: string): void {\n  const field = frm.fields_dict[fieldname];\n  if (!field?.$input) {\n    console.warn(`Campo '${fieldname}' n\u00E3o encontrado ou n\u00E3o \u00E9 um bot\u00E3o v\u00E1lido.`);\n    return;\n  }\n\n  if (field.df.fieldtype === 'Button') {\n    const $button = field.$input;\n    if ($button && $button.length) {\n      $button.removeClass('btn-default btn-secondary btn-success btn-warning btn-danger btn-info btn-light btn-dark');\n      $button.addClass('btn-primary');\n    }\n  } else {\n    console.warn(`Campo '${fieldname}' n\u00E3o \u00E9 do tipo Button.`);\n  }\n};\n\nagt.utils.form.transport_values = function(targetForm: any, field: string) {\n  if (!agt.src_frm) return;\n  if (!targetForm.doc.__islocal) return;\n\n  const fieldNames = targetForm.meta.fields.map((f: any) => f.fieldname);\n  Object.entries(agt.src_frm.fields_dict).forEach(([key, field]: any) => {\n    if (!field.value || (typeof field.value === 'string' && field.value.trim() === '')) return;\n    if (!fieldNames.includes(key)) return;\n    if (targetForm.doc[key] === field.value) return;\n    console.log(`Setting ${key} to ${field.value}`);\n    targetForm.set_value(key, field.value);\n  });\n  targetForm.set_value(field, agt.src_frm.docname);\n  targetForm.save();\n};", "frappe.provide('agt.utils.table');\nfrappe.provide('agt.utils.table.row');\n\n// Temporary fix for TypeScript issues - use any type for agt.utils\ndeclare const agt: any;\n\nagt.utils.table.row.add_one = async function<T>(form: any, child_doctype: string, fields_record: T): Promise<T> {\n  const snake_child_doctype = agt.utils.text.to_snake_case(child_doctype);\n  const child = form.add_child(snake_child_doctype, fields_record);\n  form.dirty(); // Mark as dirty to make sure the changes will be saved\n  form.refresh_field(snake_child_doctype);\n  await form.save();\n  return child as T;\n};\n\nagt.utils.table.row.add_many = async function<T>(form: any, child_doctype: string, fields_record_arr: T[]): Promise<T[]> {\n  const snake_child_doctype = agt.utils.text.to_snake_case(child_doctype);\n  const children: T[] = [];\n  fields_record_arr.forEach((fields_record: T) => {\n    const child = form.add_child(snake_child_doctype, fields_record);\n    children.push(child as T);\n  });\n  form.dirty(); // Mark as dirty to make sure the changes will be saved\n  form.refresh_field(snake_child_doctype);\n  await form.save();\n  return children;\n};\n\nagt.utils.table.row.update_one = async function(frm: any, fields_record: Record<string, string | number | null>) {\n  // For child table rows, use the doctype directly, fallback to parenttype if doctype is not available\n  const doctype_to_use = frm.doctype || frm.parenttype || 'Unknown';\n  await Promise.all(\n    Object.entries(fields_record).map(([fieldname, value]) =>\n      frappe.model.set_value(doctype_to_use, frm.name, fieldname, value)\n    )\n  );\n};\n\nagt.utils.table.row.delete_one = async function(_form: any, child_doctype: string, docname: string) {\n  frappe.model.clear_doc(child_doctype, docname);\n};\n\nagt.utils.table.row.get_one = function<T>(form: any, child_doctype: string, filters: Record<string, any>): T | undefined {\n  const snake_case_doctype = agt.utils.text.to_snake_case(child_doctype);\n  const childTable = form.doc[snake_case_doctype] as unknown as Array<Record<string, any>>;\n  if (!childTable) return;\n  return childTable.find(row => {\n    for (const [k, v] of Object.entries(filters)) {\n      if (row[k] !== v) return false;\n    }\n    return true;\n  }) as T | undefined;\n};\n\nagt.utils.table.row.get_last = function<T>(form: any, child_doctype: string): T | undefined {\n  // Convert to snake_case if not already in that format\n  const snake_case_doctype = agt.utils.text.to_snake_case(child_doctype);\n\n  const childTable = form.doc[snake_case_doctype];\n  if (!childTable) return;\n\n  return childTable[childTable.length - 1] as T | undefined;\n};\n\nagt.utils.table.row.find = function(\n  form: any,\n  child_doctype: string,\n  filters: { or?: Record<string, any>; and?: Record<string, any> }\n) {\n  const snake_case_doctype = agt.utils.text.to_snake_case(child_doctype);\n  const childTable = form.doc[snake_case_doctype] as unknown as Array<Record<string, any>>;\n  if (!childTable) return [];\n  return childTable.filter(row => {\n    if (!filters.and && !filters.or) return false;\n    \n    let andPassed = true;\n    let orPassed = false;\n    \n    if (filters.and) {\n      for (const [k, v] of Object.entries(filters.and)) {\n        if (row[k] !== v) {\n          andPassed = false;\n          break;\n        }\n      }\n    }\n    \n    if (filters.or) {\n      for (const [k, v] of Object.entries(filters.or)) {\n        if (Array.isArray(v) && v.includes(row[k])) {\n          orPassed = true;\n          break;\n        }\n        if (row[k] === v) {\n          orPassed = true;\n          break;\n        }\n      }\n    } else {\n      orPassed = true; // If there are no OR filters, consider as true\n    }\n    \n    return andPassed && orPassed;\n  });\n};\n\nagt.utils.table.row.update_last = async function(\n  form: any,\n  child_doctype: string,\n  fields_record: Record<string, string | number | null>\n) {\n  const lastRow = agt.utils.table.row.get_last(form, child_doctype);\n  if (!lastRow) return;\n  await agt.utils.table.row.update_one(lastRow as any, fields_record);\n};\n\nagt.utils.table.is_sync = async function(current: any, remote: any, docname: any, workflowStateField?: string): Promise<boolean> {\n  if (current.length !== remote.length) return false;\n\n  const currentMap = new Map(current.map((row: any) => [row[docname], row]));\n  const remoteMap = new Map(remote.map((r: any) => [r.name, r]));\n\n  // Verify if all current documents exist in remote and vice versa\n  const allDocsExist = current.every((row: any) => remoteMap.get(row[docname]))\n    && remote.every((row: any) => currentMap.has(row.name));\n\n  if (!allDocsExist) return false;\n\n  if (workflowStateField) {\n    return !remote.some((remoteItem: any) => {\n      const currentItem = currentMap.get(remoteItem.name);\n      return currentItem && (currentItem as any)[workflowStateField] !== remoteItem.workflow_state;\n    });\n  }\n  return true;\n};\n\nagt.utils.table.set_custom_properties = async function(frm: any, options: any, fieldname: string, add_row_label?: string, default_values?: Record<string, any>[], apply_only_first?: boolean): Promise<void> {\n  // if (!frm?.doc) return;\n  const elementsToHide = {\n    hide_add_row: '.grid-add-row',\n    hide_remove_row: '.grid-remove-rows',\n    hide_remove_all_rows: '.grid-remove-all-rows',\n    hide_row_check: '.grid-row-check',\n    hide_append_row: '.grid-append-row',\n    hide_shortcuts: '.grid-shortcuts',\n    hide_check: '.grid-body .grid-row .grid-row-check',\n    hide_grid_delete_row: '.grid-delete-row',\n    hide_grid_move_row: '.grid-move-row',\n  };\n\n  const field = frm.fields_dict[fieldname];\n  if (!field?.grid?.wrapper) return;\n\n  // Function to apply default values to a new row\n  const applyDefaultValues = (rowDoc: any, rowIndex: number) => {\n    if (!default_values || !Array.isArray(default_values)) return;\n\n    // Se h\u00E1 valores padr\u00E3o definidos\n    if (default_values.length > 0) {\n      // Se h\u00E1 m\u00FAltiplas op\u00E7\u00F5es de valores padr\u00E3o, usa o \u00EDndice da linha para determinar qual usar\n      // ou usa o \u00FAltimo conjunto se o \u00EDndice exceder o array\n      const defaultSet = default_values[Math.min(rowIndex, default_values.length - 1)] || default_values[0];\n\n      // Aplica os valores padr\u00E3o ao documento da linha\n      if (defaultSet) {\n        Object.entries(defaultSet).forEach(([key, value]) => {\n          if (!(key in rowDoc) || rowDoc[key] === undefined) {\n            rowDoc[key] = value;\n          }\n        });\n      }\n    }\n  };\n\n  // Function to apply visibility settings\n  const applyVisibilitySettings = () => {\n    Object.entries(elementsToHide).forEach(([option, selector]) => {\n      if (options[option as keyof typeof options] && field.grid && field.grid.wrapper) {\n        field.grid.wrapper.find(selector).hide();\n      }\n    });\n\n    if (options?.hide_config_columns === true) {\n      $(`div[data-fieldname=\"${fieldname}\"] div.col.grid-static-col.d-flex.justify-content-center`).css({ 'visibility': 'hidden' });\n      if (frm.fields_dict[fieldname]?.$wrapper) {\n        frm.fields_dict[fieldname].$wrapper.find('div.col.grid-static-col.d-flex.justify-content-center').css({ 'visibility': 'hidden' });\n      }\n    }\n  };\n\n  // Additional hook to capture specific grid events\n  const gridObj = field.grid as any;\n  if (gridObj && !gridObj._visibility_hooks_attached) {\n    gridObj._visibility_hooks_attached = true;\n\n    // Override add_new_row method if it exists\n    if (typeof gridObj.add_new_row === 'function') {\n      const originalAddNewRow = gridObj.add_new_row;\n      gridObj.add_new_row = function (...args: any[]) {\n        const result = originalAddNewRow.apply(this, args);\n\n        // Aplica valores padr\u00E3o \u00E0 nova linha se foi criada\n        if (result && default_values && Array.isArray(default_values) && default_values.length > 0) {\n          const currentRows = frm.doc[fieldname] || [];\n          const newRowIndex = currentRows.length - 1;\n\n          // Verifica se deve aplicar valores padr\u00E3o baseado no par\u00E2metro apply_only_first\n          const shouldApplyDefaults = apply_only_first === undefined || apply_only_first === false ||\n            (apply_only_first === true && newRowIndex === 0);\n\n          if (newRowIndex >= 0 && currentRows[newRowIndex] && shouldApplyDefaults) {\n            applyDefaultValues(currentRows[newRowIndex], newRowIndex);\n            // Refresh o grid para mostrar os valores aplicados\n            setTimeout(() => {\n              gridObj.refresh();\n            }, 100);\n          }\n        }\n\n        applyVisibilitySettings();\n        return result;\n      };\n    }\n\n    // Override the refresh method if it exists\n    if (typeof gridObj.refresh === 'function') {\n      const originalRefresh = gridObj.refresh;\n      gridObj.refresh = function (...args: any[]) {\n        const result = originalRefresh.apply(this, args);\n        applyVisibilitySettings();\n        return result;\n      };\n    }\n  }\n\n  if (options?.hidden !== undefined) {\n    frm.set_df_property(fieldname, 'hidden', options.hidden ? 1 : 0);\n  }\n\n  if (options?.read_only !== undefined) {\n    frm.set_df_property(fieldname, 'read_only', options.read_only ? 1 : 0);\n  }\n  if (options?.reqd !== undefined) {\n    frm.set_df_property(fieldname, 'reqd', options.reqd ? 1 : 0);\n  }\n  if (options?.label !== undefined) {\n    frm.set_df_property(fieldname, 'label', options.label);\n  }\n  if (options?.description !== undefined) {\n    frm.set_df_property(fieldname, 'description', options.description);\n  }\n  if (options?.cannot_add_rows !== undefined) {\n    frm.set_df_property(fieldname, 'cannot_add_rows', options.cannot_add_rows ? 1 : 0);\n  }\n\n  if (options?.cannot_delete_rows !== undefined) {\n    frm.set_df_property(fieldname, 'cannot_delete_rows', options.cannot_delete_rows ? 1 : 0);\n  }\n\n  if (add_row_label && frm.fields_dict[fieldname] && frm.fields_dict[fieldname].grid) {\n    frm.refresh_field(fieldname);\n    const grid = frm.fields_dict[fieldname].grid;\n    const btn = grid?.wrapper?.find('.grid-add-row');\n    if (btn && btn.length) {\n      btn.text(add_row_label);\n    }\n  }\n};\n\nagt.utils.table.custom_add_row_button = function(frm: any, fieldname: string, label: string) {\n  if (frm.fields_dict[fieldname] && frm.fields_dict[fieldname].grid) {\n    frm.refresh_field(fieldname);\n    const grid = frm.fields_dict[fieldname].grid;\n    const btn = grid?.wrapper?.find('.grid-add-row');\n    if (btn && btn.length) {\n      btn.text(label);\n    }\n  }\n};", "frappe.provide('agt.utils.text');\n\n// Temporary fix for TypeScript issues - use any type for agt.utils\ndeclare const agt: any;\n\nagt.utils.text.normalize = function(text: string): string {\n  return (text || '')\n    .toLowerCase()\n    .normalize('NFD')\n    .replace(/[\\u0300-\\u036f]/g, '') // remove acentos\n    .replace(/[-_\\s]/g, '') // remove h\u00EDfens, underlines e espa\u00E7os\n    .replace(/[^a-z0-9]/g, ''); // remove outros caracteres especiais\n};\n\nagt.utils.text.is_valid = function(v: any) {\n  return v !== null && v !== undefined && (typeof v === 'string' ? v.trim() !== '' : true);\n};\n\nagt.utils.text.to_snake_case = function(str: string) {\n  // Replace spaces with underscores\n  str = str.replace(/\\s+/g, '_');\n  // Convert PascalCase/CamelCase to snake_case\n  str = str.replace(/([a-z])([A-Z])/g, '$1_$2');\n  return str.toLowerCase();\n};\n\nagt.utils.text.to_pascal_case_spaced = function(str: string) {\n  return str\n    .replace(/([a-z])([A-Z])/g, '$1 $2') // Insert space before uppercase letters in camelCase\n    .replace(/[^a-zA-Z0-9 ]/g, ' ') // Replace non-alphanumeric characters with spaces\n    .split(/\\s+/) // Split by spaces\n    .map(word => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase()) // Capitalize each word\n    .join(' '); // Join with spaces\n};"],
  "mappings": "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",
  "names": ["frm", "cnpj_field", "cnpj", "length", "numbers", "digits", "sum", "pos", "i", "result", "_a", "response", "err", "frm", "cpf_field", "cpf", "sum", "remainder", "i", "frm", "field", "documentType", "value", "frm", "cep_field", "cep", "formatted", "field", "addr", "neigh", "town", "state", "_a", "f", "$input", "setVisualStyle", "status", "updateUI", "color", "message", "icon", "fetchCepData", "err", "validateAndStyle", "value", "digits", "data", "formatOnInput", "e", "input", "originalValue", "cursorBefore", "digitsBeforeCursor", "currentFieldValue", "isAdding", "newCursor", "countDigits", "ch", "frm", "phone_field", "digits", "phoneField", "resolve", "_a", "field", "$input", "setVisualStyle", "status", "icon", "updateUI", "color", "message", "validatePhoneFormat", "phoneNumber", "invalidDDDs", "ddd", "firstDigitAfterDDD", "formatPhoneNumber", "value", "formatOnInput", "e", "input", "originalValue", "originalPos", "digitsBeforeCursor", "formattedValue", "newCursorPos", "digitsCounted", "char", "validation", "form", "action", "callback", "_a", "doc", "params", "doctype", "docname", "workflow_state", "ignore_workflow_validation", "_b", "error", "cpf", "cnpj", "d", "sum", "i", "check", "calc", "base", "weights", "n", "w1", "w2", "digit", "digits", "response", "data", "type", "formatCpf", "formatted", "formatCnpj", "frm", "docField", "typeField", "field", "$input", "setVisualStyle", "status", "icon", "updateUI", "color", "message", "validateAndStyle", "docType", "exists", "cnpDigits", "formatOnInput", "e", "input", "originalValue", "originalPos", "digitsBeforeCursor", "maxLength", "formattedValue", "newCursorPos", "digitsCounted", "char", "ref", "title", "indicator", "url", "delay", "newTab", "doctypeSlug", "success", "item_name", "sn", "all_items", "normalizedInput", "filtered_items", "item", "uniqueMppts", "dialog_title", "resolve", "values", "mppt", "serial_no", "sn_regex", "iv_sn_regex", "other_sn_regex", "output", "docnameField", "fieldName", "result", "steps", "results", "i", "step", "filters", "__spreadValues", "joinOn", "joinValues", "item", "diagConfig", "dialog", "index", "_a", "$backdrop", "title", "dialogIndex", "d", "_frm", "message", "indicator", "timeout", "baseModalIndex", "baseBackdropIndex", "zIndex", "modalId", "doctype", "fields_target", "fields_dict", "meta", "fields_record", "acc", "k", "v", "valid_fields", "field", "targetField", "value", "valid_updates", "fieldname", "doc", "name", "r1", "e", "docname", "retryCount", "_a", "ignore_fields", "f", "updatedDoc", "message", "error", "users", "shared_users", "user", "shared", "u", "value", "frm", "configs", "fieldname", "opts", "form", "visible_fields", "field", "depends_on_json_fnc", "workflow_state", "js_visible_fields", "title", "indicator", "validate_js_visible_fields_msg", "fields", "throw_html", "message", "fieldName", "docType", "$wrapper", "doctype", "tableField", "childname", "docname", "workflowStateField", "name", "remote", "e", "currentTable", "item", "row", "_form", "options", "_a", "option", "selector", "el", "wrapper", "docOrRows", "meta", "_b", "isTable", "arr", "escapeHtml", "getFieldMeta", "metaField", "f", "autoFormat", "fieldtype", "slug", "escapedValue", "dateValue", "formattedValue", "rows", "thead", "metaF", "displayValue", "label", "table_html", "$button", "targetForm", "fieldNames", "key", "form", "child_doctype", "fields_record", "snake_child_doctype", "child", "fields_record_arr", "children", "frm", "doctype_to_use", "fieldname", "value", "_form", "docname", "filters", "snake_case_doctype", "childTable", "row", "k", "v", "andPassed", "orPassed", "lastRow", "current", "remote", "workflowStateField", "currentMap", "remoteMap", "r", "remoteItem", "currentItem", "options", "add_row_label", "default_values", "apply_only_first", "_a", "_b", "elementsToHide", "field", "applyDefaultValues", "rowDoc", "rowIndex", "defaultSet", "key", "applyVisibilitySettings", "option", "selector", "gridObj", "originalAddNewRow", "args", "result", "currentRows", "newRowIndex", "shouldApplyDefaults", "originalRefresh", "grid", "btn", "label", "text", "v", "str", "word"]
}
